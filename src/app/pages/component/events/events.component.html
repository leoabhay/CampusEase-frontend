<div class="container-fluid" *ngIf="userRole == 'admin'" >
    <div class="card">
        <div class="card-body">
            <h2 class="mb-4">Event Form</h2>
            <form class="row" [formGroup]="eventForm" (ngSubmit)="onSubmit()">
                <div class="mb-3 col-lg-4">
                  <label for="eventName" class="form-label">Event Name</label>
                  <input type="text" class="form-control" formControlName="eventName" placeholder="Enter event name" required>
                  <div *ngIf="eventForm.get('eventName')?.invalid && (eventForm.get('eventName')?.dirty || eventForm.get('eventName')?.touched)"
                       class="text-danger">
                    <div *ngIf="eventForm.get('eventName')?.errors?.['required']">
                      Event Name is required
                    </div>
                    <div *ngIf="eventForm.get('eventName')?.errors?.['pattern']">
                      Event Name must contain only alphabets and spaces
                    </div>
                  </div>
                </div>
                <div class="mb-3 col-lg-4">
                    <label for="eventDate" class="form-label">Event Date</label>
                    <input type="date" class="form-control" formControlName="eventDate" [min]="minDate" required>
                    <div *ngIf="eventForm.get('eventDate')?.invalid && (eventForm.get('eventDate')?.dirty || eventForm.get('eventDate')?.touched)"
                         class="text-danger">
                      <div *ngIf="eventForm.get('eventDate')?.errors?.['required']">
                        Event Date is required
                      </div>
                      <div *ngIf="eventForm.get('eventDate')?.errors?.['invalidDate']">
                        Event Date must be today or later
                      </div>
                    </div>
                  </div>
                <div class="mb-3 col-lg-4">
                  <label for="location" class="form-label">Location</label>
                  <input type="text" class="form-control" formControlName="location" placeholder="Enter event location" required>
                  <div *ngIf="eventForm.get('location')?.invalid && (eventForm.get('location')?.dirty || eventForm.get('location')?.touched)"
                       class="text-danger">
                    <div *ngIf="eventForm.get('location')?.errors?.['required']">
                      Location is required
                    </div>
                    <div *ngIf="eventForm.get('location')?.errors?.['pattern']">
                      Location must not contain special characters
                    </div>
                  </div>
                </div>
                <div class="mb-3 col-lg-12">
                  <label for="description" class="form-label">Description</label>
                  <textarea class="form-control" formControlName="description" rows="3" placeholder="Enter event description"></textarea>
                  <div *ngIf="eventForm.get('description')?.invalid && (eventForm.get('description')?.dirty || eventForm.get('description')?.touched)"
                       class="text-danger">
                    <div *ngIf="eventForm.get('description')?.errors?.['required']">
                      Description is required
                    </div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <button type="submit" class="btn btn-primary" [disabled]="eventForm.invalid">
                    {{ isEditMode ? 'Update' : 'Create' }}
                  </button>
                </div>
              </form>
              
        </div>
    </div>
    <div class="card my-4">
        <div class="card-body">


            <div class="table-responsive">
                <h5>Total Events </h5>
                <div class="table-responsive">
                    <table class="table table-bordered table-striped">
                        <thead>
                            <tr>
                                <th>SN</th>
                                <th>Event Name</th>
                                <th>Event Date</th>
                                <th>Location</th>
                                <th>Description</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let item of eventEmailList  let i=index">
                                <td>{{i+1}}</td>
                                <td>{{item.eventName}}</td>
                                <td>{{item.eventDate}}</td>
                                <td>{{item.location}}</td>
                                <td>{{item.description}}</td>

                                <td>
                                    <div class="btn-group" role="group" aria-label="Event Actions">
                                      <button class="btn btn-outline-primary" (click)="editEvent(item._id)">
                                        <i class="fas fa-edit"></i> 
                                      </button>
                                      <button class="btn btn-outline-danger mx-1" (click)="deleteEvent(item._id)">
                                        <i class="fas fa-trash"></i> 
                                      </button>
                                    </div>
                                  </td>
                                  
                            </tr>

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<div *ngIf="userRole == 'student'">
  <h2>All Events</h2>
  <div class="table-responsive">
    <table class="table table-bordered" id="clubTable">
      <thead class="thead-dark">
        <tr>
          <th>SN</th>
          <th>Event Name</th>
          <th>Event Date</th>
          <th>Location</th>
          <th>Description</th>
          <th>Created Date</th>
          <th>Created By</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of eventList | paginate: { itemsPerPage: 10, currentPage: currentPage }; let i = index">
          <td>{{ (currentPage - 1) * 10 + i + 1 }}</td>
          <td>{{ item.eventName }}</td>
          <td>{{ item.eventDate }}</td>
          <td>{{ item.location }}</td>
          <td>{{ item.description }}</td>
          <td>{{ item.createdDate }}</td>
          <td>{{ item.createdBy }}</td>
        </tr>
      </tbody>
    </table>
  </div>
  <pagination-controls (pageChange)="currentPage = $event"></pagination-controls>
</div>
